<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <link rel="stylesheet" href="css/style.css">
    <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.css" />


    <title>Log In</title>

    <style>



@import url("https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,500&display=swap");
html { overflow-y: scroll; }

.break{
  padding-top: 70px;
}

.break2{
  padding-top: 25px;
}

.break3{
  padding-top: 15px;
}

.center{
  text-align: center;
  float: center;

}

.navbar-nav > form{
  padding-left:0px;
  padding-right:65px;
}

.container-fluid {
  background: url("images/background-photo2.jpg");
  background-size: cover;
  background-position: center center;
  background-attachment: fixed;
}

.h1 {
font-weight: 800;
  font-size: 40px;
}

.h2 {
  text-align: center;
}

.btn-search {
  min-width: 100px;
  height: 40px;
  padding: 0 15px;
  background: #1a2d4e;
  white-space: nowrap;
  border-radius: 3px;
  font-size: 16px;
  color: #fff;
  transition: all .2s ease-out, color .2s ease-out;
  border: 0;
  cursor: pointer;
  margin-left: 2px;

}

.btn-search:hover{
  background:#111e33;
}

.form-control {    
background: url("images/search3.png");
background-color: white;
background-size: 35px 35px;
background-position: top left;
background-repeat: no-repeat;
padding-left:40px;   
}

.card {
  border: none;
}

.card img {
  padding: 50px;
}

.card-body {
  text-align: center;
}

.vid {
  font-size: 40px;
  font-weight: 700;
  text-align: center;
}

    </style>

    
  </head>
  <body>

        <!-- Navigation Menu -->
        <nav class="navbar navbar-expand-lg bg-white navbar-light fixed-top">
          <div class="container">
            <a class="navbar-brand" href="index.html">
              <img src="images/navbar-logo-45.png" alt="">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">

              <ul class="navbar-nav ml-auto text-primary">
                <li class="nav-item">
                  <a class="nav-link text-secondary" aria-current="page" href="#">Home</a>
                </li>

                <li class="nav-item">
                  <a class="nav-link text-secondary" href="#">Search</a>
                </li>
      
                <li class="nav-item">
                  <a class="nav-link text-secondary" href="#">Sign In/Register</a>
                </li>


               <!-- <li class="nav-item dropdown">
                  <a class="nav-link text-secondary dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-expanded="false">
                    My Account
                  </a>
                  <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                    <li><a class="dropdown-item" href="#">My Profile</a></li>
                    <li><a class="dropdown-item" href="#">Post a Book</a></li>
                    <li><a class="dropdown-item" href="#">Option 2</a></li>
                    <li><a class="dropdown-item" href="#">Option 2</a></li>
                  </ul>
                </li>-->
              </ul>
            </div>
          </div>
        </nav>
        <div class="container-fluid">
          <div class="break"></div>

<div class="break">  </div> 
<div class="container pt-4">


  <div id="firebaseui-auth-container"></div>
  <div id="loader">Loading...</div>
<div class="break"></div>

</div>




  </div>
</div>                


    <!-- /row -->


<hr>
<!-- footer -->
<div class="container">
<div class="row py-3">
  <div class="col-md-7">
  <ul class="nav">
  <li class="nav-item">
    <a class="nav-link text-info" href="about.html">Our Team</a>
  </li>
  <li class="nav-item">
    <a class="nav-link text-info" href="contact.html">Contact</a>
  </li>
  <li class="nav-item">
    <a class="nav-link text-info" href="help.html">Help</a>
  </li>
 
</ul>
  </div>
  <div class="col-md text-md-right">
    <small>&copy; Website created by Team 19 for COMP 1800 Winter 2021</small>
  </div>
</div><!-- /footer -->      
</div> <!-- /Container-->



<!-- JavaScript and dependencies -->

<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/5.0.0-alpha1/js/bootstrap.min.js" integrity="sha384-oesi62hOLfzrys4LxRF63OJCXdXDipiYWBnvTl9Y9/TRlw5xlKIEHpNyvvDShgf/" crossorigin="anonymous"></script>

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="/__/firebase/8.3.1/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->

<!-- Initialize Firebase -->
<script src="/__/firebase/init.js"></script>

<script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/ui/4.6.1/firebase-ui-auth.js"></script>

<script src="scripts/firebase_api.js"></script>

<script>
// Initialize the FirebaseUI Widget using Firebase.
    var ui = new firebaseui.auth.AuthUI(firebase.auth());

    var uiConfig = {
  callbacks: {
    signInSuccessWithAuthResult: function (authResult, redirectUrl) {
                    // User successfully signed in.
                    // Return type determines whether we continue the redirect automatically
                    // or whether we leave that to developer to handle.
                    //------------------------------------------------------------------------------------------
                    // The code below is modified from default snippet provided by the FB documentation.
                    //
                    // If the user is a "brand new" user, then create a new "user" in your own database.
                    // Assign this user with the name and email provided.
                    // Before this works, you must enable "Firestore" from the firebase console.
                    // The Firestore rules must allow the user to write. 
                    //------------------------------------------------------------------------------------------
                    var user = authResult.user;
                    if (authResult.additionalUserInfo.isNewUser) {         //if new user
                        db.collection("users").doc(user.uid).set({         //write to firestore
                                name: user.displayName,                    //"users" collection
                                email: user.email                          //with authenticated user's ID (user.uid)
                            }).then(function () {
                                console.log("New user added to firestore");
                                window.location.assign("home.html");       //re-direct to main.html after signup
                            })
                            .catch(function (error) {
                                console.log("Error adding new user: " + error);
                            });
                    } else {
                        return true;
                    }
                    return false;
                },
    uiShown: function() {
      // The widget is rendered.
      // Hide the loader.
      document.getElementById('loader').style.display = 'none';
    }
  },
  // Will use popup for IDP Providers sign-in flow instead of the default, redirect.
  signInFlow: 'popup',
  signInSuccessUrl: 'home.html',
  signInOptions: [
    // Leave the lines as is for the providers you want to offer your users.
    // firebase.auth.GoogleAuthProvider.PROVIDER_ID,
    // firebase.auth.FacebookAuthProvider.PROVIDER_ID,
    // firebase.auth.TwitterAuthProvider.PROVIDER_ID,
    // firebase.auth.GithubAuthProvider.PROVIDER_ID,
    firebase.auth.EmailAuthProvider.PROVIDER_ID,
    // firebase.auth.PhoneAuthProvider.PROVIDER_ID
  ],
  // Terms of service url.
  tosUrl: '<your-tos-url>',
  // Privacy policy url.
  privacyPolicyUrl: '<your-privacy-policy-url>'
};

// The start method will wait until the DOM is loaded.
ui.start('#firebaseui-auth-container', uiConfig);
    </script>

</body>
</html>